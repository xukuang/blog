<!DOCTYPE html>
  <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
    <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
      <meta name="author" content="Xu Kuang" />
        <title>三维图在R中的几种画法 | Xu Kuang</title>
        <link rel="shortcut icon" href="/favicon.ico">
          <link href="http://xukuang.github.io/blog/feed/" rel="alternate" title="Xu Kuang" type="application/atom+xml" />
            <link rel="stylesheet" href="/media/css/style.css">
              <link rel="stylesheet" href="/media/css/highlight.css">
                <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
                  <!--highlight.js Start-->
                  <link rel="stylesheet" title="Default" href="/media/js/styles/tomorrow-night-blue.css">
                    <script type="text/javascript" src="/media/js/highlight.pack.js"></script>
                      <script>
                      hljs.configure({tabReplace: '    '});
                    hljs.initHighlightingOnLoad();
                    </script>
                      <!--highlight.js End-->
                      <!--mathjax start-->
                      <script type="text/javascript"
                      src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
                        </script>
                        
                        <!--mathjax end-->
                        </head>
                        <body>
                        <div id="container">
                          <div id="main" role="main">
                            <header>
                            <h1>三维图在R中的几种画法</h1>
                            </header>
                            <nav>
                            <!-- Sidebar -->
                            <h5 id="logo" style="text-align:center;">
                              <a href="http://xukuang.github.io/">HOME</a></h5>
                                <span><a title="blog" class="" href="http://xukuang.github.io/blog/">BLOG</a></span>
                                  <span><a title="about" class="" href="http://xukuang.github.io/blog/about/">ABOUT</a></span>
                                    <span><a title="categories" class="" href="http://xukuang.github.io/blog/categories/">CATEGORIES</a></span>
                                      <span><a title="vitae" class="" href="http://xukuang.github.io/blog/vitae/">VITAE</a></span>
                                        <span><a title="tags" class="" href="http://xukuang.github.io/blog/tags/">TAGS</a></span>
                                          <span><a title="links" class="" href="http://xukuang.github.io/blog/links/">LINKS</a></span>
                                            <span><a title="subscribe by RSS" class="" href="http://xukuang.github.io/blog/feed/">SUBSCRIBE</a></span>
                                              </nav>
                                              <article class="content">
                                              <section class="post">
<h2 id="persp">基础函数persp</h2>

<h3 id="persp-1">persp函数</h3>

<div class="highlighter-rouge"><pre class="highlight"><code>persp(x = seq(0, 1, length.out = nrow(z)),
      y = seq(0, 1, length.out = ncol(z)),
      z, xlim = range(x), ylim = range(y),
      zlim = range(z, na.rm = TRUE),
      xlab = NULL, ylab = NULL, zlab = NULL,
      main = NULL, sub = NULL,
      theta = 0, phi = 15, r = sqrt(3), d = 1,
      scale = TRUE, expand = 1,
      col = "white", border = NULL, ltheta = -135, lphi = 0,
      shade = NA, box = TRUE, axes = TRUE, nticks = 5,
      ticktype = "simple", ...)
</code></pre>
</div>
<!--more-->

<ol>
  <li>参数x和y分别是两个数值向量，z是一个与前两个参数对应的矩阵</li>
  <li>xlim、ylim和zlim分别设定三个坐标轴的范围</li>
  <li>xlab、ylab和zlab分别设定三个坐标轴的标题</li>
  <li>theta和phi分别设定立体图形左右方向和上下方向旋转的角度</li>
  <li>r设定眼睛离透视图中心的距离，这个距离的远近会给我们一种从远近看物体的感觉</li>
  <li>d设定立体效果的程度，大于1的值会减弱立体程度，反之会增强立体程度</li>
  <li>scale为逻辑值，决定是否对三个坐标进行缩放，若为TRUE，则x、y和z都会被缩放到[0, 1]范围内，若为FALSE，那么所有坐标轴都按照数据的原始量纲处理，这样可以得到数据的真实比例</li>
  <li>expand为z轴的缩放因子，它决定了z轴的长短</li>
  <li>col为组成曲面的所有小方块的颜色；border为组成曲面的小方块的边框样式，设置为NA可以去掉边
框</li>
  <li>ltheta和lphi设置透视图的光源位置</li>
  <li>shade决定的阴影效果；box为逻辑值，设定透视图是否需要画外框</li>
  <li>axes决定是否画坐标轴；nticks为坐标轴刻度线的数目；ticktype设定坐标轴刻度类型，取值’simple’则简单画箭头表示坐标轴，’detailed’则将详细的刻度标记在坐标轴上</li>
</ol>

<h3 id="section">实例</h3>
<p>这里我们使用persp函数来展示一下二维正态分布密度函数图。
二维正态分布密度函数的公式：
$f(x1, x2) = \frac{ 1 }{2\pi \sigma1\sigma2\sqrt{1-r^2}}e^{-\frac{1}{2(1-r^2)} 
[\frac{(x1-\mu_{x1})^2}{\sigma_{x1}^2} - \frac{2r(x1-\mu_{x1})(x2-\mu_{x2})}{\sigma_{x1} \sigma_{x2}} + \frac{(x2-\mu_{x2})^2}{\sigma_{x2}^2}]}$</p>

<div class="highlighter-rouge"><pre class="highlight"><code>mu1&lt;-0 # setting the expected value of x1
mu2&lt;-0 # setting the expected value of x2
s11&lt;-10 # setting the variance of x1
s12&lt;-15 # setting the covariance between x1 and x2
s22&lt;-10 # setting the variance of x2
rho&lt;-0.5 # setting the correlation coefficient between x1 and x2
x1&lt;-seq(-10,10,length=41) # generating the vector series x1
x2&lt;-x1 # copying x1 to x2

f&lt;-function(x1,x2)
{
term1&lt;-1/(2*pi*sqrt(s11*s22*(1-rho^2)))
term2&lt;--1/(2*(1-rho^2))
term3&lt;-(x1-mu1)^2/s11
term4&lt;-(x2-mu2)^2/s22
term5&lt;--2*rho*((x1-mu1)*(x2-mu2))/(sqrt(s11)*sqrt(s22))

term1*exp(term2*(term3+term4-term5))
} # setting up the function of the multivariate normal density
#
z&lt;-outer(x1,x2,f) # calculating the density values
#
persp(x1, x2, z,
main="Two dimensional Normal Distribution",
sub=expression(italic(f)~(bold(x))==frac(1,2~pi~sqrt(sigma[11]~
sigma[22]~(1-rho^2)))~phantom(0)^bold(.)~exp~bgroup("{",
list(-frac(1,2(1-rho^2)),
bgroup("[", frac((x[1]~-~mu[1])^2, sigma[11])~-~2~rho~frac(x[1]~-~mu[1],
sqrt(sigma[11]))~ frac(x[2]~-~mu[2],sqrt(sigma[22]))~+~
frac((x[2]~-~mu[2])^2, sigma[22]),"]")),"}")),
col="lightblue",
theta=30, phi=20,
r=50,
d=0.1,
expand=0.5,
ltheta=90, lphi=180,
shade=0.75,
ticktype="detailed",
nticks=5) # produces the 3-D plot
#
mtext(expression(list(mu[1]==0,mu[2]==0,sigma[11]==10,sigma[22]==10,sigma[12
]==15,rho==0.5)), side=3) # adding a text line to the graph
</code></pre>
</div>

<p><img src="http://xukuang.github.io/blog/images/二维正态分布图.png" alt="二维正态分布图" /></p>

<h2 id="lattice">lattice包的函数</h2>

<div class="highlighter-rouge"><pre class="highlight"><code>library(lattice)
data(iris)
cloud(Sepal.Length ~ Petal.Length * Petal.Width, data = iris,
groups = Species,
perspective = FALSE,
key = list(title = "Iris Data", x = .05, y=.95, border = TRUE,
points = Rows(trellis.par.get("superpose.symbol"), 1:3),
text = list(levels(iris$Species))))
</code></pre>
</div>

<p><img src="http://xukuang.github.io/blog/images/示例图.png" alt="示例图" /></p>

<h2 id="scatterplot3d">scatterplot3d包的函数</h2>
<p>scatterplot3d包主要包含三个函数，其中：</p>

<ul>
  <li>scatterplotplot3d函数为包scatterplot3d的基础函数，能够打开画图，画出点或线</li>
  <li>points3d向用函数scatterplotplot3d画好的图上添加点或线</li>
  <li>plane3d向用函数scatterplotplot3d画好的图上添加趋势面</li>
</ul>

<div class="highlighter-rouge"><pre class="highlight"><code>library(scatterplot3d)
data(trees)
s3d &lt;- scatterplot3d(trees, type="h", highlight.3d=TRUE,
angle=55, scale.y=0.7, pch=16, main="Volume ~ Grith + Height")
# Now adding some points to the "scatterplot3d"
s3d$points3d(seq(10,20,2), seq(85,60,-5), seq(60,10,-10),
col="blue", type="h", pch=16)
# Now adding a regression plane to the "scatterplot3d"
attach(trees)
my.lm &lt;- lm(Volume ~ Girth + Height)
s3d$plane3d(my.lm)
</code></pre>
</div>

<p><img src="http://xukuang.github.io/blog/images/趋势面.png" alt="树木体积与胸径和高度关系图" /></p>

<h2 id="rgl">rgl包的函数</h2>
<p>利用rgl包作出的三维图像，可以通过鼠标调整不同的角度。</p>

<div class="highlighter-rouge"><pre class="highlight"><code>library(rgl)
plot3d(1:5,1:5, z = c(10, 20, 30, 40, 70), col="red", size=5)
# save image
rgl.snapshot('plot1.png')
rgl.postscript("plot1.pdf", "pdf", drawText = TRUE)
  r3dDefaults
    open3d()
    shade3d(cube3d(color = rep(rainbow(6), rep(4, 6))))
	rgl.snapshot('plot2.png')
rgl.postscript("plot2.pdf", "pdf", drawText = TRUE)
    save &lt;- par3d(userMatrix = rotationMatrix(90*pi/180, 1, 0, 0))
    save
    par3d("userMatrix")    
    par3d(save)
    par3d("userMatrix")
</code></pre>
</div>

<h3 id="section-1">画外篇</h3>
<p>下面的部分与文章主题没有关系，只是记述一下<strong>hexo</strong>中数学公式的表示方式。</p>

<script type="math/tex; mode=display">\cos 2\theta = \cos^2 \theta - \sin^2 \theta =  2 \cos^2 \theta - 1</script>

<script type="math/tex; mode=display">\frac{\partial u}{\partial t} = h^2 \left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} + \frac{\partial^2 u}{\partial z^2}\right)</script>

<script type="math/tex; mode=display">i\hbar\frac{\partial \psi}{\partial t} = \frac{-\hbar^2}{2m} \left( \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2} \right) \psi + V \psi.</script>

</section>
<section class="meta">



<span>
	<a  href="http://xukuang.github.io/blog/2015/05/push-ups/" class="pageNav"  >Previous</a>
	&nbsp;&nbsp;&nbsp;
	<a  href="http://xukuang.github.io/blog/2016/01/join-function/" class="pageNav"  >Next</a>
</span>


<span class="author">
  <a href="http://xukuang.github.io/blog">Xu Kuang</a>
</span>
<span class="time">
  /
  <time datetime="2016-01-10">2016-01-10</time>
</span>
<br />
<span class="license">
  Published under <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/">(CC) BY-NC-SA</a>
</span>

<span class="categories">
  in categories
  
  <a href="http://xukuang.github.io/blog/categories/#技术篇" title="技术篇">技术篇</a>&nbsp;
  
</span>


<span class="tags">
  tagged with 
  
  <a href="http://xukuang.github.io/blog/tags/#三维图" title="三维图">三维图</a>&nbsp;
  
  <a href="http://xukuang.github.io/blog/tags/#R" title="R">R</a>&nbsp;
  
</span>

</section>
<div id="disqus_thread"></div>
<script>
/**
* RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
* LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');

s.src = '//httpxukuanggithubio.disqus.com/embed.js';

s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

<script type="text/javascript">
$(function(){
  $(document).keydown(function(e) {
    if (e.target.nodeName.toUpperCase() != 'BODY') return;
    var url = false;
        if (e.which == 37 || e.which == 74) {  // Left arrow and J
            
        url = 'http://xukuang.github.io/blog/2015/05/push-ups/';
        
        }
        else if (e.which == 39 || e.which == 75) {  // Right arrow and K
            
        url = 'http://xukuang.github.io/blog/2016/01/join-function/';
        
        }
        if (url) {
            window.location = url;
        }
  });
})
</script>


                                              </article>
                                                </div>
                                                </div>
                                                <script type="text/javascript">
                                                  var _gaq = _gaq || [];
                                                  _gaq.push(['_setAccount', '']);
                                                  _gaq.push(['_trackPageview']);
                                                  (function() {
                                                    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                                                    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                                                    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
                                                  })();
                                                  </script>
                                                    </body>
                                                    </html>
                                                    